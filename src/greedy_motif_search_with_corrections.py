__author__ = 'nikita_kartashov'

from profile_most_probable_kmer import NUCLEOTIDES_FOR_PROBABILITIES
from greedy_motif_search import greedy_motif_search
from utils.pyutils import transpose


def build_profile_columns_with_corrections(motifs):
    columns = transpose(motifs)

    def column_probabilites(column):
        return [(column.count(nucleotide) + 1) * 1.0 / len(column) for nucleotide in NUCLEOTIDES_FOR_PROBABILITIES]

    return [column_probabilites(column) for column in columns]


if __name__ == '__main__':
    DNA_STRINGS = """GGTTACCCAACTCGCTTTCAGTATCCAGAAACATTATCAATCCTTCGCAGGTGGTTCATGGTGCTGAAAGCATATTGAGGCAGCACACCGGGCGGTTTTGCCAGGTTGTCGCTCGCCCCGGTTTGTCCCAGCAACAACGCAAAGGAAGTGCCTGGA
CAAGGTACAATGATAGGATCTTCGTATGGTTTCTCCTGAATAGCTTAGTCATACTGGCGTCCGCGGAGCAGAAGGAGCACCCGGTAAGCTTACCTACGGGTTGTGTATGGAGCGAAGGGTAGGGAGGAGCTATGCTTGGTTGATACTTGGTGGAGT
ATTACTAAAGCACGTTATTGCGCGTAAATTTTTGCTCTTTAGGGCCGCATGGAAACTGATAAGCATGTTGGCCGCGTTCGGTATACCGCTGTTACTTCGTTAGAGCCGGCTCACCCAGCGAGCGACCCATGCTCCTATGGGGAAGAAGGCTAGCAC
CTTCGCGTATAGTGCATGAAAGTTTCGCCTCGGCGATATGTCCCGGCCTGTCCTGTTTCATATGCAGGCCCGGTTCTCGCAGAAGATCCGAGTGCCGTCACGGATGGAAAGAGACCTTCACGACTTGTGTATCGCTCGATATAGGGCGACATCGAC
TCTGTAACCGAAGTAGCGTGGCTCAACCATCCGCCATAGCGCTTAATCATGCCTATTCCTCTAAGGTTTTGTCGTAGGTTGTTCCGAATTCAGTATCTCACCGCCAGAGAAGACCTCAGCCCTCTTAGATGCTGTGAGCTTTTCAGGGGGTACAGG
CTACGGACCGTCTCCGTATGCTGCTTGGGGCCAAGGAGGCTAGCCAATAAGTCTCCGTAACTCGCCCAGGTACCCGGAATCCGTGAACATTCTTCTCGCCTTGCGTATGTCTTGTCCCGAGGCCATTACTCGTTCATACGGCCACCCTTTAAGATT
CGAATTGTACGTGCTCACACCCTAGGCGTGTTCCACAGTGTGGTATTTGCAACCATACCCCCATTATAGCACGCCTCTTAACGATAATATTGTACTCGCATTGAGTATTTTGAATGACTGAGATTCAGTTCGCCCATCCTGAAATCGCACATCCCT
TTATAATCCTGGATTCTGTAAGGTATCTAGCGTTGCCAAACTTAGCAATGCCGTGGGGTATTTCGTATCGGGAGCAACCAATCATTTTAGGAGGCGCGGTTTAAGTATAGGGTGTGAGACAATAGCACGTACACGATTAATGTCAAGCATGCGTGC
AGGTGGTTATCTACATGTAGGAGAGGTCCCGTCAGACTATGCTATAAGGATGTTTACGCTGTTAAAATTGATAATGTGGCACTTGTAAACGACAGCCATCATCCACTTGCCTCTCACTTACGTTTTGTGTATTCCTACCTGTTCTGGAGTCACGCG
GTATCCTTCTGTTGCAGTATCCCTCGCATTAAGTATACCTTTGGCAAGGAATTCGTGGGCTACCCACAACTTGTTTACGGTGTTCAGGCTGCATGAACTTCATACTCATCTTTGAATCCGCGTCGGAAGGTTGGCACATCTGTTGAAAGACGTTGA
CACAGAAACGTCAGCCACTCTGGGCGTGGTGTATTATAGGTCAATCAGGCTAGTAGGGGCAACGCTCCCGAAGAGACCCCTTAGCTACTGCCCGGTATTCGTAACACTCGATTTTGGTATGAAGGTTACAATGGTTGGACTCGTACCAAAGTTGTT
ATAGGATTTGCACATCGCATGATGGCATGATTCTGTGTCTCCCTTCTTTCGGAATTTCGATATGGATTATTATTCGGGCGTCTTATCGAATGTCGCAACGGTGTGAGTCGACTTGCGTATCTCAGCCGTTGGATTCTCAGCTTGCTATTTGGCCTA
AGCCTTAATCCCCCGGAATCCCGGACTGCTCTGCTTCGATTTAGGTATCGTATATATGGACCCCGTAGAATCCCTCGGAACAGCGGAAGGTTAATTGCATGGCTCGAACTATTCCAAAAAGATCGCGAAAACTATACCTCAGCATCGTTTGTTCGC
GTAGGGCGGGAACAGACCAAAGAAATGGCATGCGCCAGGTATTCGTATTTAATGAAAGTAATTATACGTGGGAGAGTCCAATAATTCTGCACCTCTATCCTCGGGTCTCGGTTTAGGTATGTGCGCAACGAATACTTTAGTCATATAGGATGTCGG
CGGTCGCAACAGGAGGAATGGCCCGGCAGGACACAAGTCTACATGTGGGTGGGCCTTGGCCGGTGATACCGGGCGTGGTTGAACCCAGGCTGTCAAGCCAGGGTGATGTAACAATCTTCTCGGAAATCTCCTTACAGGCCGGCTCGTATTGGGTAT
GCATGGCTCCTATAAGGCCTTTCCCGTCTTAAGTATTCATTTTCGTAATGGAGAACCCACACCCAGGCAGAGTATACCCTTCACGTTGATCGTGAGGAATCCTTCGACTTAAACGATTGATTATCCCCTATGTCGATAATAGGGAAAGTGGGATTT
CGCGTTCCGTATTGGGCCTTGACACCCAGACTACGACCCAGGGAGTGGACCACGCACCCGCGGATTATGATTTCCCGAATCGTGAGTCTACACTCGCATGAAGCAGCGATTTAGCTATTGACGGCTCGTGGAAATTCACAAAAGTCTTTCAGAATC
AGTGCACAGTTCATGCTACTCCGTAAAAACGACGTACTAATGATGTTAGTACAGGGCCCTTCACTAGGTAGCCCTTCCGAATGTTATGTACTTTAGTGAATCTTACTGCGCGGGTGCGAAAAAATCTATCATACGTTCATCATACGCCTTACGTAT
GTCATATCGAACCCGTTATACCACATGTATATGACTCAACCTATCAACGCACAAAGAGGCCCCCTTGCGACGGATGACCAGCAGCGTGTTACGTATGATGCTAGCATATGCAAAGTTGAGTGCCAATTACGGAACGCGCAATCCACTAGTTCGCAG
CTGAAACACGCACGAAGAAATAGTCGGCTTGTGTATGTTCTCCCCGTCGAACGTTCTCAACAGGGGATAGTGCGTGGTCGCAGCCCACAAGTTCCACTCGCCAATAATGTCTTATTAAGTTATTTGGCGTTGGCTTCGCAGATGCGAAGGGATTCA
GAATAAACGGTAAACGGCAGTAACGGATAAATTATCGCCTGCCTGTAGGCCGCCTGTCTCGAGTGCTCAGCCCACGCGTTGTAAATTATTTAAAATTCACGGCAGGAGGAACAGACTTCGGGCCCAGCTTACGAATGATTTCGGCGAGTTACGTAT
TGAATGAGCCATCAGAATTAAGATCCCAAGGGCCTGAAGCTTAGCGCCCGGGTTTGGTATTTCGTGCACATGAATCTAGAACCCGAACTTACCGTCTCAAGGCTGCAGACCATACTTTCGTACGCTTTAGAGAAAGCAAGTGATAGAATTTAAAAG
TTCTGAACCCCATTACTAGTACCACGCTTTAAGTATCCCCCCCATATAACTTTAAAGGAACAACTGCTTTGTAGCAACCATCATTCCAAGTTCGCCCTCGATCTAATTGGCTAAGCCCTTTGAGGTGAGGTATCATTTCCGGGGGTTGCTTAGGTT
AAATACTCAAATCAGTAATATTGCTGATCGCCGCCGCGGGTTTTGTATTATAGCTTCTAGCTCCTGAGCAATTTTTAGCGATTGCCTGACGCGGACAATGTCGTAAGACTATCCTGTTTATAGACGGTGGCCACCCTCAAACCCAATTTTCCCGGG
TAGTCCTACTTGGATTTAGACGTAAACCAATGCCAGCAGCGAGTCCGCAACAGCAAAAAGGACATTTTAGTTAAAGCACGGTCGTCAGCATAAATCTTTCGCATTATTTCTGTTGACTAAAAAGTCGCTAGCCGGTTTGAGTATTTACATACCAAA
    """.split()
    K = 12
    print('\n'.join(greedy_motif_search(DNA_STRINGS, K, build_profile_columns_with_corrections)))
